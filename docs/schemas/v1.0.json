{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Exported Function (Discovery Output)",
  "version": "1.0.0",
  "description": "Contract for Section 2-3 discovery pipeline output. Consumed by Section 4 (MCP generation).",
  "type": "object",
  "properties": {
    "function": {
      "type": "string",
      "description": "Exported function name (mangled or unmangled)"
    },
    "ordinal": {
      "type": "integer",
      "description": "Export ordinal (1-based index)"
    },
    "rva": {
      "type": "string",
      "pattern": "^0x[0-9a-fA-F]+$",
      "description": "Relative Virtual Address in hex format (e.g., '0x12345')"
    },
    "confidence": {
      "type": "string",
      "enum": ["Low", "Medium", "High"],
      "description": "Invocability confidence: Low (ordinal-only, forwarded, no match), Medium (name + partial info), High (header match + signature)"
    },
    "is_signed": {
      "type": "boolean",
      "description": "True if binary is digitally signed"
    },
    "publisher": {
      "type": ["string", "null"],
      "description": "Publisher name from digital certificate (null if unsigned)"
    },
    "is_forwarded": {
      "type": "boolean",
      "description": "True if export is forwarded to another DLL (e.g., kernel32.SomeFunc=NTDLL.NtSomeFunc)"
    }
  },
  "required": ["function", "ordinal", "rva", "confidence"],
  "additionalProperties": false,
  "examples": [
    {
      "function": "ZSTD_compress",
      "ordinal": 1,
      "rva": "0x12345",
      "confidence": "High",
      "is_signed": true,
      "publisher": "Zstandard Project",
      "is_forwarded": false
    },
    {
      "function": "GetModuleHandleA",
      "ordinal": 42,
      "rva": "0xABCDEF",
      "confidence": "Low",
      "is_signed": true,
      "publisher": "Microsoft Corporation",
      "is_forwarded": true
    }
  ]
}
